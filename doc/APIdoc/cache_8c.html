<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>TLDNS Relay: src/cache.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">TLDNS Relay<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Design a DNS relay server programme, read the ``domain name - IP address&#39;&#39; control table, when the client queries the IP address corresponding to the domain name, use the domain name to retrieve the control table, there may be three kinds of search results.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('cache_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">cache.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="cache_8h_source.html">../include/cache.h</a>&quot;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;uv.h&gt;</code><br />
<code>#include &quot;<a class="el" href="log_8h_source.html">../include/log.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="dns__parse_8h_source.html">../include/dns_parse.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for cache.c:</div>
<div class="dyncontent">
<div class="center"><img src="cache_8c__incl.png" border="0" usemap="#asrc_2cache_8c" alt=""/></div>
<map name="asrc_2cache_8c" id="asrc_2cache_8c">
<area shape="rect" title=" " alt="" coords="267,5,356,31"/>
<area shape="rect" href="cache_8h.html" title=" " alt="" coords="5,79,130,105"/>
<area shape="poly" title=" " alt="" coords="271,34,124,77,123,72,269,29"/>
<area shape="rect" title=" " alt="" coords="153,79,217,105"/>
<area shape="poly" title=" " alt="" coords="291,34,221,73,218,69,289,29"/>
<area shape="rect" title=" " alt="" coords="241,79,305,105"/>
<area shape="poly" title=" " alt="" coords="307,32,289,66,284,64,303,30"/>
<area shape="rect" title=" " alt="" coords="329,79,374,105"/>
<area shape="poly" title=" " alt="" coords="320,30,340,64,335,67,316,33"/>
<area shape="rect" href="log_8h.html" title=" " alt="" coords="398,79,505,105"/>
<area shape="poly" title=" " alt="" coords="336,29,415,69,413,74,334,34"/>
<area shape="rect" href="dns__parse_8h.html" title=" " alt="" coords="468,153,617,178"/>
<area shape="poly" title=" " alt="" coords="357,18,396,23,439,33,482,50,519,77,536,106,543,137,538,138,531,108,515,81,479,55,437,38,395,28,356,23"/>
<area shape="rect" title=" " alt="" coords="256,153,316,178"/>
<area shape="poly" title=" " alt="" coords="105,103,242,147,240,152,104,108"/>
<area shape="rect" href="linklist__rbtree_8h.html" title=" " alt="" coords="50,153,160,178"/>
<area shape="poly" title=" " alt="" coords="76,104,94,138,89,140,71,106"/>
<area shape="rect" title=" " alt="" coords="76,226,134,252"/>
<area shape="poly" title=" " alt="" coords="108,179,108,211,102,211,102,179"/>
<area shape="rect" href="dns_8h.html" title=" " alt="" coords="282,226,336,252"/>
<area shape="poly" title=" " alt="" coords="140,176,268,221,267,226,139,181"/>
<area shape="rect" title=" " alt="" coords="277,300,341,326"/>
<area shape="poly" title=" " alt="" coords="312,252,312,284,306,284,306,252"/>
<area shape="poly" title=" " alt="" coords="425,108,329,149,327,144,422,103"/>
<area shape="rect" href="config_8h.html" title=" " alt="" coords="377,153,444,178"/>
<area shape="poly" title=" " alt="" coords="447,106,427,141,422,138,442,104"/>
<area shape="poly" title=" " alt="" coords="503,181,351,228,349,223,502,176"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3aa8d6fa65bbd42c0b6327c67362234d" id="r_a3aa8d6fa65bbd42c0b6327c67362234d"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3aa8d6fa65bbd42c0b6327c67362234d">BKDRHash</a> (const uint8_t *str)</td></tr>
<tr class="memdesc:a3aa8d6fa65bbd42c0b6327c67362234d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the hash of a string using the BKDR hash algorithm.  <br /></td></tr>
<tr class="separator:a3aa8d6fa65bbd42c0b6327c67362234d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c6dd0d6aa6f172b089056e27c11e7da" id="r_a8c6dd0d6aa6f172b089056e27c11e7da"><td class="memItemLeft" align="right" valign="top">static uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a8c6dd0d6aa6f172b089056e27c11e7da">get_min_ttl</a> (const <a class="el" href="dns_8h.html#aaa587ac980f7833500ee4367842bda36">Dns_RR</a> *prr)</td></tr>
<tr class="memdesc:a8c6dd0d6aa6f172b089056e27c11e7da"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the smallest TTL (Time-To-Live) value in a list of Resource Records (RRs).  <br /></td></tr>
<tr class="separator:a8c6dd0d6aa6f172b089056e27c11e7da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ced4e1f620d2e750fb0c2c049962fa8" id="r_a6ced4e1f620d2e750fb0c2c049962fa8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6ced4e1f620d2e750fb0c2c049962fa8">cache_insert</a> (<a class="el" href="cache_8h.html#aacb3cd9ae53f433578c171271fb89409">Cache</a> *<a class="el" href="main_8c.html#a219405a7efb1068433bdef1efa916e8a">cache</a>, const <a class="el" href="dns_8h.html#af9793e5f9c4dc6b1a90865331e9fe741">Dns_Msg</a> *msg)</td></tr>
<tr class="memdesc:a6ced4e1f620d2e750fb0c2c049962fa8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a DNS message into the cache.  <br /></td></tr>
<tr class="separator:a6ced4e1f620d2e750fb0c2c049962fa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85397655f041915af32d1846796578a4" id="r_a85397655f041915af32d1846796578a4"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="linklist__rbtree_8h.html#a3ad9484222f2163212fb74af65a20935">Rbtree_Value</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a85397655f041915af32d1846796578a4">cache_query</a> (<a class="el" href="cache_8h.html#aacb3cd9ae53f433578c171271fb89409">Cache</a> *<a class="el" href="main_8c.html#a219405a7efb1068433bdef1efa916e8a">cache</a>, const <a class="el" href="dns_8h.html#a06e3c3727e6fc5c1df11c165d649df5c">Dns_Que</a> *que)</td></tr>
<tr class="memdesc:a85397655f041915af32d1846796578a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Query the cache for a DNS question.  <br /></td></tr>
<tr class="separator:a85397655f041915af32d1846796578a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a558b15d81ce86a0a4afa5a64e6fd8055" id="r_a558b15d81ce86a0a4afa5a64e6fd8055"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cache_8h.html#aacb3cd9ae53f433578c171271fb89409">Cache</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a558b15d81ce86a0a4afa5a64e6fd8055">new_cache</a> (FILE *hosts_file)</td></tr>
<tr class="memdesc:a558b15d81ce86a0a4afa5a64e6fd8055"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a new cache and initialize it with data from the hosts file.  <br /></td></tr>
<tr class="separator:a558b15d81ce86a0a4afa5a64e6fd8055"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a3aa8d6fa65bbd42c0b6327c67362234d" name="a3aa8d6fa65bbd42c0b6327c67362234d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aa8d6fa65bbd42c0b6327c67362234d">&#9670;&#160;</a></span>BKDRHash()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int BKDRHash </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *</td>          <td class="paramname"><span class="paramname"><em>str</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the hash of a string using the BKDR hash algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">str</td><td>The input string. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The computed hash value. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cache_8c_a3aa8d6fa65bbd42c0b6327c67362234d_icgraph.png" border="0" usemap="#acache_8c_a3aa8d6fa65bbd42c0b6327c67362234d_icgraph" alt=""/></div>
<map name="acache_8c_a3aa8d6fa65bbd42c0b6327c67362234d_icgraph" id="acache_8c_a3aa8d6fa65bbd42c0b6327c67362234d_icgraph">
<area shape="rect" title="Compute the hash of a string using the BKDR hash algorithm." alt="" coords="381,56,472,82"/>
<area shape="rect" href="cache_8c.html#a6ced4e1f620d2e750fb0c2c049962fa8" title="Insert a DNS message into the cache." alt="" coords="238,5,333,31"/>
<area shape="poly" title=" " alt="" coords="373,53,322,34,324,29,375,48"/>
<area shape="rect" href="cache_8c.html#a558b15d81ce86a0a4afa5a64e6fd8055" title="Create a new cache and initialize it with data from the hosts file." alt="" coords="103,56,190,82"/>
<area shape="poly" title=" " alt="" coords="366,72,191,72,191,66,366,66"/>
<area shape="rect" href="cache_8c.html#a85397655f041915af32d1846796578a4" title="Query the cache for a DNS question." alt="" coords="238,107,333,132"/>
<area shape="poly" title=" " alt="" coords="375,90,324,109,322,104,373,85"/>
<area shape="poly" title=" " alt="" coords="235,39,185,58,183,53,233,34"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,56,55,82"/>
<area shape="poly" title=" " alt="" coords="87,72,55,72,55,66,87,66"/>
<area shape="poly" title=" " alt="" coords="233,103,183,85,185,80,235,98"/>
</map>
</div>

</div>
</div>
<a id="a6ced4e1f620d2e750fb0c2c049962fa8" name="a6ced4e1f620d2e750fb0c2c049962fa8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ced4e1f620d2e750fb0c2c049962fa8">&#9670;&#160;</a></span>cache_insert()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void cache_insert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cache_8h.html#aacb3cd9ae53f433578c171271fb89409">Cache</a> *</td>          <td class="paramname"><span class="paramname"><em>cache</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="dns_8h.html#af9793e5f9c4dc6b1a90865331e9fe741">Dns_Msg</a> *</td>          <td class="paramname"><span class="paramname"><em>msg</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Insert a DNS message into the cache. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache where the message will be inserted. </td></tr>
    <tr><td class="paramname">msg</td><td>The DNS message to be inserted. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cache_8c_a6ced4e1f620d2e750fb0c2c049962fa8_cgraph.png" border="0" usemap="#acache_8c_a6ced4e1f620d2e750fb0c2c049962fa8_cgraph" alt=""/></div>
<map name="acache_8c_a6ced4e1f620d2e750fb0c2c049962fa8_cgraph" id="acache_8c_a6ced4e1f620d2e750fb0c2c049962fa8_cgraph">
<area shape="rect" title="Insert a DNS message into the cache." alt="" coords="5,80,101,106"/>
<area shape="rect" href="cache_8c.html#a3aa8d6fa65bbd42c0b6327c67362234d" title="Compute the hash of a string using the BKDR hash algorithm." alt="" coords="149,5,239,31"/>
<area shape="poly" title=" " alt="" coords="78,77,153,36,156,41,80,82"/>
<area shape="rect" href="dns__parse_8c.html#a04774941b5c9d0297b083fbf61c09196" title="Copy a Resource Record." alt="" coords="151,55,237,80"/>
<area shape="poly" title=" " alt="" coords="101,82,136,75,136,80,102,87"/>
<area shape="rect" href="cache_8c.html#a8c6dd0d6aa6f172b089056e27c11e7da" title="Get the smallest TTL (Time&#45;To&#45;Live) value in a list of Resource Records (RRs)." alt="" coords="151,104,237,130"/>
<area shape="poly" title=" " alt="" coords="102,98,136,104,136,110,101,104"/>
<area shape="rect" href="linklist__rbtree_8c.html#ac1e7b55e2083949b45865ea07af04f9b" title="Create a new linked list." alt="" coords="149,153,239,179"/>
<area shape="poly" title=" " alt="" coords="81,104,155,143,153,148,78,109"/>
<area shape="rect" href="linklist__rbtree_8c.html#a8e0bfadc9752f04f500905a85c47e74e" title="Delete the next element in the linked list." alt="" coords="287,104,419,130"/>
<area shape="poly" title=" " alt="" coords="237,150,294,132,295,137,239,155"/>
<area shape="rect" href="linklist__rbtree_8c.html#a41e95176ba82f906d4ecc38a385f66f7" title="Insert a new element into the linked list." alt="" coords="305,153,402,179"/>
<area shape="poly" title=" " alt="" coords="239,164,289,164,289,169,239,169"/>
<area shape="rect" href="linklist__rbtree_8c.html#afec00073759abba4629e2fa2dcaf9d2e" title="Query the next element in the linked list." alt="" coords="289,203,418,228"/>
<area shape="poly" title=" " alt="" coords="239,177,295,195,294,200,237,182"/>
<area shape="rect" href="dns__parse_8c.html#a70f17de617dc9a8a1a87e966b35bf273" title="Release memory allocated for a Resource Record." alt="" coords="467,104,568,130"/>
<area shape="poly" title=" " alt="" coords="420,114,452,114,452,120,420,120"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cache_8c_a6ced4e1f620d2e750fb0c2c049962fa8_icgraph.png" border="0" usemap="#acache_8c_a6ced4e1f620d2e750fb0c2c049962fa8_icgraph" alt=""/></div>
<map name="acache_8c_a6ced4e1f620d2e750fb0c2c049962fa8_icgraph" id="acache_8c_a6ced4e1f620d2e750fb0c2c049962fa8_icgraph">
<area shape="rect" title="Insert a DNS message into the cache." alt="" coords="238,5,333,31"/>
<area shape="rect" href="cache_8c.html#a558b15d81ce86a0a4afa5a64e6fd8055" title="Create a new cache and initialize it with data from the hosts file." alt="" coords="103,5,190,31"/>
<area shape="poly" title=" " alt="" coords="223,21,190,21,190,16,223,16"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a85397655f041915af32d1846796578a4" name="a85397655f041915af32d1846796578a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85397655f041915af32d1846796578a4">&#9670;&#160;</a></span>cache_query()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="linklist__rbtree_8h.html#a3ad9484222f2163212fb74af65a20935">Rbtree_Value</a> * cache_query </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cache_8h.html#aacb3cd9ae53f433578c171271fb89409">Cache</a> *</td>          <td class="paramname"><span class="paramname"><em>cache</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="dns_8h.html#a06e3c3727e6fc5c1df11c165d649df5c">Dns_Que</a> *</td>          <td class="paramname"><span class="paramname"><em>que</em></span>&#160;)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Query the cache for a DNS question. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cache</td><td>The cache to query. </td></tr>
    <tr><td class="paramname">que</td><td>The DNS question. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value found in the cache or NULL if not found. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cache_8c_a85397655f041915af32d1846796578a4_cgraph.png" border="0" usemap="#acache_8c_a85397655f041915af32d1846796578a4_cgraph" alt=""/></div>
<map name="acache_8c_a85397655f041915af32d1846796578a4_cgraph" id="acache_8c_a85397655f041915af32d1846796578a4_cgraph">
<area shape="rect" title="Query the cache for a DNS question." alt="" coords="5,55,101,80"/>
<area shape="rect" href="cache_8c.html#a3aa8d6fa65bbd42c0b6327c67362234d" title="Compute the hash of a string using the BKDR hash algorithm." alt="" coords="149,5,239,31"/>
<area shape="poly" title=" " alt="" coords="91,52,140,34,141,39,93,57"/>
<area shape="rect" href="dns__parse_8c.html#a04774941b5c9d0297b083fbf61c09196" title="Copy a Resource Record." alt="" coords="151,55,237,80"/>
<area shape="poly" title=" " alt="" coords="101,65,136,65,136,70,101,70"/>
<area shape="rect" href="linklist__rbtree_8c.html#ac1e7b55e2083949b45865ea07af04f9b" title="Create a new linked list." alt="" coords="149,104,239,130"/>
<area shape="poly" title=" " alt="" coords="93,78,141,96,140,101,91,83"/>
<area shape="rect" href="linklist__rbtree_8c.html#a8e0bfadc9752f04f500905a85c47e74e" title="Delete the next element in the linked list." alt="" coords="287,55,419,80"/>
<area shape="poly" title=" " alt="" coords="237,101,294,83,295,88,239,106"/>
<area shape="rect" href="linklist__rbtree_8c.html#a41e95176ba82f906d4ecc38a385f66f7" title="Insert a new element into the linked list." alt="" coords="305,104,402,130"/>
<area shape="poly" title=" " alt="" coords="239,114,289,114,289,120,239,120"/>
<area shape="rect" href="linklist__rbtree_8c.html#afec00073759abba4629e2fa2dcaf9d2e" title="Query the next element in the linked list." alt="" coords="289,153,418,179"/>
<area shape="poly" title=" " alt="" coords="239,128,295,146,294,151,237,133"/>
<area shape="rect" href="dns__parse_8c.html#a70f17de617dc9a8a1a87e966b35bf273" title="Release memory allocated for a Resource Record." alt="" coords="467,55,568,80"/>
<area shape="poly" title=" " alt="" coords="420,65,452,65,452,70,420,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cache_8c_a85397655f041915af32d1846796578a4_icgraph.png" border="0" usemap="#acache_8c_a85397655f041915af32d1846796578a4_icgraph" alt=""/></div>
<map name="acache_8c_a85397655f041915af32d1846796578a4_icgraph" id="acache_8c_a85397655f041915af32d1846796578a4_icgraph">
<area shape="rect" title="Query the cache for a DNS question." alt="" coords="238,5,333,31"/>
<area shape="rect" href="cache_8c.html#a558b15d81ce86a0a4afa5a64e6fd8055" title="Create a new cache and initialize it with data from the hosts file." alt="" coords="103,5,190,31"/>
<area shape="poly" title=" " alt="" coords="223,21,190,21,190,16,223,16"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a8c6dd0d6aa6f172b089056e27c11e7da" name="a8c6dd0d6aa6f172b089056e27c11e7da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c6dd0d6aa6f172b089056e27c11e7da">&#9670;&#160;</a></span>get_min_ttl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint32_t get_min_ttl </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="dns_8h.html#aaa587ac980f7833500ee4367842bda36">Dns_RR</a> *</td>          <td class="paramname"><span class="paramname"><em>prr</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the smallest TTL (Time-To-Live) value in a list of Resource Records (RRs). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">prr</td><td>The head node of the RR linked list. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The minimum TTL value. </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cache_8c_a8c6dd0d6aa6f172b089056e27c11e7da_icgraph.png" border="0" usemap="#acache_8c_a8c6dd0d6aa6f172b089056e27c11e7da_icgraph" alt=""/></div>
<map name="acache_8c_a8c6dd0d6aa6f172b089056e27c11e7da_icgraph" id="acache_8c_a8c6dd0d6aa6f172b089056e27c11e7da_icgraph">
<area shape="rect" title="Get the smallest TTL (Time&#45;To&#45;Live) value in a list of Resource Records (RRs)." alt="" coords="381,5,467,31"/>
<area shape="rect" href="cache_8c.html#a6ced4e1f620d2e750fb0c2c049962fa8" title="Insert a DNS message into the cache." alt="" coords="238,5,333,31"/>
<area shape="poly" title=" " alt="" coords="366,21,334,21,334,16,366,16"/>
<area shape="rect" href="cache_8c.html#a558b15d81ce86a0a4afa5a64e6fd8055" title="Create a new cache and initialize it with data from the hosts file." alt="" coords="103,5,190,31"/>
<area shape="poly" title=" " alt="" coords="223,21,190,21,190,16,223,16"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
<a id="a558b15d81ce86a0a4afa5a64e6fd8055" name="a558b15d81ce86a0a4afa5a64e6fd8055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a558b15d81ce86a0a4afa5a64e6fd8055">&#9670;&#160;</a></span>new_cache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cache_8h.html#aacb3cd9ae53f433578c171271fb89409">Cache</a> * new_cache </td>
          <td>(</td>
          <td class="paramtype">FILE *</td>          <td class="paramname"><span class="paramname"><em>hosts_file</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a new cache and initialize it with data from the hosts file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hosts_file</td><td>The file containing hosts data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The newly created cache. </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cache_8c_a558b15d81ce86a0a4afa5a64e6fd8055_cgraph.png" border="0" usemap="#acache_8c_a558b15d81ce86a0a4afa5a64e6fd8055_cgraph" alt=""/></div>
<map name="acache_8c_a558b15d81ce86a0a4afa5a64e6fd8055_cgraph" id="acache_8c_a558b15d81ce86a0a4afa5a64e6fd8055_cgraph">
<area shape="rect" title="Create a new cache and initialize it with data from the hosts file." alt="" coords="5,207,93,232"/>
<area shape="rect" href="cache_8c.html#a3aa8d6fa65bbd42c0b6327c67362234d" title="Compute the hash of a string using the BKDR hash algorithm." alt="" coords="286,156,376,182"/>
<area shape="poly" title=" " alt="" coords="93,204,140,192,270,172,270,177,141,197,94,209"/>
<area shape="rect" href="cache_8c.html#a6ced4e1f620d2e750fb0c2c049962fa8" title="Insert a DNS message into the cache." alt="" coords="141,105,236,131"/>
<area shape="poly" title=" " alt="" coords="65,204,139,148,153,138,156,142,142,152,68,209"/>
<area shape="rect" href="linklist__rbtree_8c.html#ac1e7b55e2083949b45865ea07af04f9b" title="Create a new linked list." alt="" coords="577,207,667,232"/>
<area shape="poly" title=" " alt="" coords="90,230,141,242,257,251,374,248,479,238,561,227,562,232,479,244,374,253,257,256,140,247,89,236"/>
<area shape="rect" href="cache_8c.html#a85397655f041915af32d1846796578a4" title="Query the cache for a DNS question." alt="" coords="141,207,236,232"/>
<area shape="poly" title=" " alt="" coords="93,217,125,217,125,222,93,222"/>
<area shape="rect" href="linklist__rbtree_8c.html#a6223e88c82874af7ec915b7fe8240204" title="Initialize a new red&#45;black tree This function allocates memory for a new red&#45;black tree and its nil n..." alt="" coords="146,333,231,359"/>
<area shape="poly" title=" " alt="" coords="66,231,163,321,160,325,63,235"/>
<area shape="poly" title=" " alt="" coords="228,129,280,148,278,153,226,134"/>
<area shape="rect" href="dns__parse_8c.html#a04774941b5c9d0297b083fbf61c09196" title="Copy a Resource Record." alt="" coords="288,107,373,132"/>
<area shape="poly" title=" " alt="" coords="237,116,272,116,272,122,237,121"/>
<area shape="rect" href="cache_8c.html#a8c6dd0d6aa6f172b089056e27c11e7da" title="Get the smallest TTL (Time&#45;To&#45;Live) value in a list of Resource Records (RRs)." alt="" coords="288,5,373,31"/>
<area shape="poly" title=" " alt="" coords="207,103,282,48,297,38,300,42,286,52,210,107"/>
<area shape="poly" title=" " alt="" coords="229,102,299,88,339,86,378,92,440,112,499,140,591,195,588,200,497,144,438,117,377,97,338,92,299,93,230,107"/>
<area shape="rect" href="linklist__rbtree_8c.html#a8e0bfadc9752f04f500905a85c47e74e" title="Delete the next element in the linked list." alt="" coords="722,155,854,180"/>
<area shape="poly" title=" " alt="" coords="665,204,730,183,731,188,666,209"/>
<area shape="rect" href="linklist__rbtree_8c.html#a41e95176ba82f906d4ecc38a385f66f7" title="Insert a new element into the linked list." alt="" coords="740,204,837,230"/>
<area shape="poly" title=" " alt="" coords="667,216,724,215,725,221,667,221"/>
<area shape="rect" href="linklist__rbtree_8c.html#afec00073759abba4629e2fa2dcaf9d2e" title="Query the next element in the linked list." alt="" coords="724,253,853,279"/>
<area shape="poly" title=" " alt="" coords="668,229,726,246,725,251,666,235"/>
<area shape="rect" href="dns__parse_8c.html#a70f17de617dc9a8a1a87e966b35bf273" title="Release memory allocated for a Resource Record." alt="" coords="902,155,1003,180"/>
<area shape="poly" title=" " alt="" coords="855,165,887,165,887,170,855,170"/>
<area shape="poly" title=" " alt="" coords="226,204,278,185,280,190,228,209"/>
<area shape="poly" title=" " alt="" coords="203,204,238,174,282,141,287,138,290,143,286,146,241,178,206,208"/>
<area shape="poly" title=" " alt="" coords="237,217,562,217,562,222,237,222"/>
<area shape="rect" href="linklist__rbtree_8c.html#ae46c23eec5c1ea21ebab9279843de3a3" title="Insert a key&#45;value pair into the red&#45;black tree." alt="" coords="284,333,377,359"/>
<area shape="poly" title=" " alt="" coords="232,344,269,344,269,349,232,349"/>
<area shape="rect" href="linklist__rbtree_8c.html#aec09451763b49da3023b2742685de07f" title="Query the red&#45;black tree for a key." alt="" coords="284,436,377,462"/>
<area shape="poly" title=" " alt="" coords="210,357,301,424,297,429,206,362"/>
<area shape="rect" href="linklist__rbtree_8c.html#a2003ed64d170c0cf2c2b3a9899eb2557" title="Adjust the shape of the red&#45;black tree to keep it balanced." alt="" coords="578,359,666,384"/>
<area shape="poly" title=" " alt="" coords="378,348,563,364,562,369,377,353"/>
<area shape="rect" href="linklist__rbtree_8c.html#a9e27afd2a9929b02687afda68d8a68b5" title="Initialize a node and allocate memory." alt="" coords="437,308,510,334"/>
<area shape="poly" title=" " alt="" coords="377,335,421,327,422,333,378,340"/>
<area shape="poly" title=" " alt="" coords="596,360,591,350,594,341,605,334,622,332,640,335,650,341,647,346,638,340,622,337,607,339,599,344,597,350,601,357"/>
<area shape="rect" href="linklist__rbtree_8c.html#ad1b052785e6b7bcc62cba39a7402a1b6" title="Get the grandparent of a node." alt="" coords="908,379,997,404"/>
<area shape="poly" title=" " alt="" coords="659,355,722,340,788,331,818,333,855,340,890,352,920,368,918,373,887,357,854,345,817,338,789,337,722,345,660,361"/>
<area shape="rect" href="linklist__rbtree_8c.html#ab62e652e4fc283a274b30e1f1f08c211" title="Rotate a node to the left." alt="" coords="749,404,828,430"/>
<area shape="poly" title=" " alt="" coords="667,381,734,400,733,405,666,386"/>
<area shape="rect" href="linklist__rbtree_8c.html#aef6fab1149a4f11067237f95c7bdb41f" title="Rotate a node to the right." alt="" coords="745,453,831,479"/>
<area shape="poly" title=" " alt="" coords="641,383,677,411,723,440,732,444,730,449,721,444,674,415,637,387"/>
<area shape="rect" href="linklist__rbtree_8c.html#a06530033a166619f9dfac249ac51e285" title="Get the uncle of a node." alt="" coords="762,355,814,380"/>
<area shape="poly" title=" " alt="" coords="667,368,746,366,746,371,667,373"/>
<area shape="poly" title=" " alt="" coords="828,408,892,398,893,403,829,413"/>
<area shape="poly" title=" " alt="" coords="827,450,853,440,913,410,916,415,855,445,829,455"/>
<area shape="poly" title=" " alt="" coords="815,369,892,380,892,385,814,374"/>
<area shape="poly" title=" " alt="" coords="493,305,520,287,588,239,591,244,523,291,496,310"/>
<area shape="rect" href="linklist__rbtree_8c.html#a787a8de67855978e27d86ddcc1dfc2fc" title="Delete a node from the red&#45;black tree." alt="" coords="425,491,522,516"/>
<area shape="poly" title=" " alt="" coords="367,460,425,482,423,487,365,465"/>
<area shape="rect" href="linklist__rbtree_8c.html#a7a4895b028aba0f94b5b640e085c548e" title="Recursively search for a node with a given key starting from a given node." alt="" coords="432,436,515,462"/>
<area shape="poly" title=" " alt="" coords="378,446,417,446,417,452,378,452"/>
<area shape="rect" href="linklist__rbtree_8c.html#ac734d64a69533759abbc046c6266e951" title="Adjust the shape of the red&#45;black tree to keep it balanced." alt="" coords="576,452,668,478"/>
<area shape="poly" title=" " alt="" coords="521,488,561,478,562,483,523,494"/>
<area shape="rect" href="linklist__rbtree_8c.html#a05ef0ed79d24a2628b928224a4139c3b" title="Destroy a node in the red&#45;black tree." alt="" coords="572,501,672,527"/>
<area shape="poly" title=" " alt="" coords="522,504,557,507,557,512,522,510"/>
<area shape="rect" href="linklist__rbtree_8c.html#aa763522130715b07d70cdbcff94c1d2e" title="Get the smallest child node in a subtree." alt="" coords="570,575,674,600"/>
<area shape="poly" title=" " alt="" coords="500,515,585,564,583,569,497,519"/>
<area shape="poly" title=" " alt="" coords="667,449,733,430,735,435,669,454"/>
<area shape="poly" title=" " alt="" coords="668,463,730,463,729,468,668,468"/>
<area shape="poly" title=" " alt="" coords="596,453,591,443,594,434,605,428,622,425,640,428,650,435,647,439,638,433,622,431,607,433,599,437,597,443,601,450"/>
<area shape="rect" href="linklist__rbtree_8c.html#afcb59301147f1364f3eaf43fe11430fa" title="Get the sibling of a node." alt="" coords="759,503,817,528"/>
<area shape="poly" title=" " alt="" coords="667,476,745,500,744,505,666,481"/>
<area shape="poly" title=" " alt="" coords="596,576,591,566,594,557,605,550,622,548,640,551,650,557,647,562,638,556,622,553,607,555,599,560,597,566,601,573"/>
<area shape="poly" title=" " alt="" coords="449,437,444,427,447,418,457,412,474,409,491,412,500,419,497,423,489,417,473,415,459,417,451,421,449,427,454,434"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="cache_8c_a558b15d81ce86a0a4afa5a64e6fd8055_icgraph.png" border="0" usemap="#acache_8c_a558b15d81ce86a0a4afa5a64e6fd8055_icgraph" alt=""/></div>
<map name="acache_8c_a558b15d81ce86a0a4afa5a64e6fd8055_icgraph" id="acache_8c_a558b15d81ce86a0a4afa5a64e6fd8055_icgraph">
<area shape="rect" title="Create a new cache and initialize it with data from the hosts file." alt="" coords="103,5,190,31"/>
<area shape="rect" href="main_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title=" " alt="" coords="5,5,55,31"/>
<area shape="poly" title=" " alt="" coords="87,21,55,21,55,16,87,16"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="cache_8c.html">cache.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0 </li>
  </ul>
</div>
</body>
</html>
