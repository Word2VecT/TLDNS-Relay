\doxysection{src/dns\+\_\+server.c File Reference}
\hypertarget{dns__server_8c}{}\label{dns__server_8c}\index{src/dns\_server.c@{src/dns\_server.c}}
{\ttfamily \#include "{}../include/dns\+\_\+server.\+h"{}}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include "{}../include/log.\+h"{}}\newline
{\ttfamily \#include "{}../include/dns\+\_\+parse.\+h"{}}\newline
{\ttfamily \#include "{}../include/dns\+\_\+print.\+h"{}}\newline
{\ttfamily \#include "{}../include/query\+\_\+pool.\+h"{}}\newline
Include dependency graph for dns\+\_\+server.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dns__server_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{dns__server_8c_a55af4a4772ee42f239e2befc7b1190c7}{alloc\+\_\+buffer}} (uv\+\_\+handle\+\_\+t \texorpdfstring{$\ast$}{*}handle, size\+\_\+t suggested\+\_\+size, uv\+\_\+buf\+\_\+t \texorpdfstring{$\ast$}{*}buf)
\begin{DoxyCompactList}\small\item\em Allocate space for the buffer. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{dns__server_8c_a10ad14f6993fac66edbf5d2f6a75aa62}{on\+\_\+send}} (uv\+\_\+udp\+\_\+send\+\_\+t \texorpdfstring{$\ast$}{*}req, int status)
\begin{DoxyCompactList}\small\item\em Callback function for sending response messages to local clients. \end{DoxyCompactList}\item 
static void \mbox{\hyperlink{dns__server_8c_a3f5c9971834e8a6c273a8584c42c46a3}{on\+\_\+read}} (uv\+\_\+udp\+\_\+t \texorpdfstring{$\ast$}{*}handle, ssize\+\_\+t nread, const uv\+\_\+buf\+\_\+t \texorpdfstring{$\ast$}{*}buf, const struct sockaddr \texorpdfstring{$\ast$}{*}addr, unsigned flags)
\begin{DoxyCompactList}\small\item\em Callback function for receiving query messages from local clients. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{dns__server_8c_a79a2c087d5c414b08de43d6344a1950a}{init\+\_\+server}} (uv\+\_\+loop\+\_\+t \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{main_8c_add769cb3887f840e6e7be962492de960}{loop}})
\begin{DoxyCompactList}\small\item\em Initialize the DNS server. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{dns__server_8c_a9c27be19d71612df0b60fd5c68d0502a}{send\+\_\+to\+\_\+local}} (const struct sockaddr \texorpdfstring{$\ast$}{*}addr, const \mbox{\hyperlink{dns_8h_af9793e5f9c4dc6b1a90865331e9fe741}{Dns\+\_\+\+Msg}} \texorpdfstring{$\ast$}{*}msg)
\begin{DoxyCompactList}\small\item\em Send a DNS response message to local clients. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static uv\+\_\+udp\+\_\+t \mbox{\hyperlink{dns__server_8c_a125c2f8e4ef0170e771e52eab324dbf7}{server\+\_\+socket}}
\begin{DoxyCompactList}\small\item\em Socket for server communication with local clients. \end{DoxyCompactList}\item 
static struct sockaddr\+\_\+in \mbox{\hyperlink{dns__server_8c_ab68c13e44aff4b13c0e9a04ab2cbf71e}{recv\+\_\+addr}}
\begin{DoxyCompactList}\small\item\em Address for receiving DNS query messages. \end{DoxyCompactList}\item 
\mbox{\hyperlink{query__pool_8h_ab473e597588e70ec88aa19fa55ab6cae}{Query\+\_\+\+Pool}} \texorpdfstring{$\ast$}{*} \mbox{\hyperlink{dns__server_8c_a72e226b504514a1ea5a74389ad36ece6}{qpool}}
\begin{DoxyCompactList}\small\item\em Query pool. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{dns__server_8c_a55af4a4772ee42f239e2befc7b1190c7}\index{dns\_server.c@{dns\_server.c}!alloc\_buffer@{alloc\_buffer}}
\index{alloc\_buffer@{alloc\_buffer}!dns\_server.c@{dns\_server.c}}
\doxysubsubsection{\texorpdfstring{alloc\_buffer()}{alloc\_buffer()}}
{\footnotesize\ttfamily \label{dns__server_8c_a55af4a4772ee42f239e2befc7b1190c7} 
static void alloc\+\_\+buffer (\begin{DoxyParamCaption}\item[{uv\+\_\+handle\+\_\+t \texorpdfstring{$\ast$}{*}}]{handle}{, }\item[{size\+\_\+t}]{suggested\+\_\+size}{, }\item[{uv\+\_\+buf\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Allocate space for the buffer. 


\begin{DoxyParams}{Parameters}
{\em handle} & Allocation handle \\
\hline
{\em suggested\+\_\+size} & Suggested buffer size \\
\hline
{\em buf} & Buffer to be allocated\\
\hline
\end{DoxyParams}
Allocates a buffer of fixed size DNS\+\_\+\+STRING\+\_\+\+MAX\+\_\+\+SIZE for receiving DNS query messages from local clients. Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=316pt]{dns__server_8c_a55af4a4772ee42f239e2befc7b1190c7_icgraph}
\end{center}
\end{figure}
\Hypertarget{dns__server_8c_a79a2c087d5c414b08de43d6344a1950a}\index{dns\_server.c@{dns\_server.c}!init\_server@{init\_server}}
\index{init\_server@{init\_server}!dns\_server.c@{dns\_server.c}}
\doxysubsubsection{\texorpdfstring{init\_server()}{init\_server()}}
{\footnotesize\ttfamily \label{dns__server_8c_a79a2c087d5c414b08de43d6344a1950a} 
void init\+\_\+server (\begin{DoxyParamCaption}\item[{uv\+\_\+loop\+\_\+t \texorpdfstring{$\ast$}{*}}]{loop}{}\end{DoxyParamCaption})}



Initialize the DNS server. 


\begin{DoxyParams}{Parameters}
{\em loop} & The libuv event loop \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dns__server_8c_a79a2c087d5c414b08de43d6344a1950a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=214pt]{dns__server_8c_a79a2c087d5c414b08de43d6344a1950a_icgraph}
\end{center}
\end{figure}
\Hypertarget{dns__server_8c_a3f5c9971834e8a6c273a8584c42c46a3}\index{dns\_server.c@{dns\_server.c}!on\_read@{on\_read}}
\index{on\_read@{on\_read}!dns\_server.c@{dns\_server.c}}
\doxysubsubsection{\texorpdfstring{on\_read()}{on\_read()}}
{\footnotesize\ttfamily \label{dns__server_8c_a3f5c9971834e8a6c273a8584c42c46a3} 
static void on\+\_\+read (\begin{DoxyParamCaption}\item[{uv\+\_\+udp\+\_\+t \texorpdfstring{$\ast$}{*}}]{handle}{, }\item[{ssize\+\_\+t}]{nread}{, }\item[{const uv\+\_\+buf\+\_\+t \texorpdfstring{$\ast$}{*}}]{buf}{, }\item[{const struct sockaddr \texorpdfstring{$\ast$}{*}}]{addr}{, }\item[{unsigned}]{flags}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Callback function for receiving query messages from local clients. 


\begin{DoxyParams}{Parameters}
{\em handle} & Query handle \\
\hline
{\em nread} & Number of bytes received \\
\hline
{\em buf} & Buffer containing the received message \\
\hline
{\em addr} & Address of the local sender \\
\hline
{\em flags} & Flags indicating special conditions for the received data \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dns__server_8c_a3f5c9971834e8a6c273a8584c42c46a3_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=301pt]{dns__server_8c_a3f5c9971834e8a6c273a8584c42c46a3_icgraph}
\end{center}
\end{figure}
\Hypertarget{dns__server_8c_a10ad14f6993fac66edbf5d2f6a75aa62}\index{dns\_server.c@{dns\_server.c}!on\_send@{on\_send}}
\index{on\_send@{on\_send}!dns\_server.c@{dns\_server.c}}
\doxysubsubsection{\texorpdfstring{on\_send()}{on\_send()}}
{\footnotesize\ttfamily \label{dns__server_8c_a10ad14f6993fac66edbf5d2f6a75aa62} 
static void on\+\_\+send (\begin{DoxyParamCaption}\item[{uv\+\_\+udp\+\_\+send\+\_\+t \texorpdfstring{$\ast$}{*}}]{req}{, }\item[{int}]{status}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Callback function for sending response messages to local clients. 


\begin{DoxyParams}{Parameters}
{\em req} & Send handle \\
\hline
{\em status} & Send status, indicating whether the send was successful \\
\hline
\end{DoxyParams}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dns__server_8c_a10ad14f6993fac66edbf5d2f6a75aa62_icgraph}
\end{center}
\end{figure}
\Hypertarget{dns__server_8c_a9c27be19d71612df0b60fd5c68d0502a}\index{dns\_server.c@{dns\_server.c}!send\_to\_local@{send\_to\_local}}
\index{send\_to\_local@{send\_to\_local}!dns\_server.c@{dns\_server.c}}
\doxysubsubsection{\texorpdfstring{send\_to\_local()}{send\_to\_local()}}
{\footnotesize\ttfamily \label{dns__server_8c_a9c27be19d71612df0b60fd5c68d0502a} 
void send\+\_\+to\+\_\+local (\begin{DoxyParamCaption}\item[{const struct sockaddr \texorpdfstring{$\ast$}{*}}]{addr}{, }\item[{const \mbox{\hyperlink{dns_8h_af9793e5f9c4dc6b1a90865331e9fe741}{Dns\+\_\+\+Msg}} \texorpdfstring{$\ast$}{*}}]{msg}{}\end{DoxyParamCaption})}



Send a DNS response message to local clients. 


\begin{DoxyParams}{Parameters}
{\em addr} & The address of the local client \\
\hline
{\em msg} & The DNS message to be sent \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dns__server_8c_a9c27be19d71612df0b60fd5c68d0502a_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dns__server_8c_a9c27be19d71612df0b60fd5c68d0502a_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\Hypertarget{dns__server_8c_a72e226b504514a1ea5a74389ad36ece6}\index{dns\_server.c@{dns\_server.c}!qpool@{qpool}}
\index{qpool@{qpool}!dns\_server.c@{dns\_server.c}}
\doxysubsubsection{\texorpdfstring{qpool}{qpool}}
{\footnotesize\ttfamily \label{dns__server_8c_a72e226b504514a1ea5a74389ad36ece6} 
\mbox{\hyperlink{query__pool_8h_ab473e597588e70ec88aa19fa55ab6cae}{Query\+\_\+\+Pool}}\texorpdfstring{$\ast$}{*} qpool\hspace{0.3cm}{\ttfamily [extern]}}



Query pool. 

\Hypertarget{dns__server_8c_ab68c13e44aff4b13c0e9a04ab2cbf71e}\index{dns\_server.c@{dns\_server.c}!recv\_addr@{recv\_addr}}
\index{recv\_addr@{recv\_addr}!dns\_server.c@{dns\_server.c}}
\doxysubsubsection{\texorpdfstring{recv\_addr}{recv\_addr}}
{\footnotesize\ttfamily \label{dns__server_8c_ab68c13e44aff4b13c0e9a04ab2cbf71e} 
struct sockaddr\+\_\+in recv\+\_\+addr\hspace{0.3cm}{\ttfamily [static]}}



Address for receiving DNS query messages. 

\Hypertarget{dns__server_8c_a125c2f8e4ef0170e771e52eab324dbf7}\index{dns\_server.c@{dns\_server.c}!server\_socket@{server\_socket}}
\index{server\_socket@{server\_socket}!dns\_server.c@{dns\_server.c}}
\doxysubsubsection{\texorpdfstring{server\_socket}{server\_socket}}
{\footnotesize\ttfamily \label{dns__server_8c_a125c2f8e4ef0170e771e52eab324dbf7} 
uv\+\_\+udp\+\_\+t server\+\_\+socket\hspace{0.3cm}{\ttfamily [static]}}



Socket for server communication with local clients. 

